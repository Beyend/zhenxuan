webpackJsonp([12],{I3BL:function(t,a){},QXW3:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"Job",data:function(){return{chatList:[],content:"",chatImg:"",userId:localStorage.getItem("userId"),userName:"",userImg:"",shopid:"",shopname:"",shoplogo:"",timer:null}},mounted:function(){this.shopid=this.$route.query.data.shopid,this.shopname=this.$route.query.data.shopname,this.shoplogo=this.$route.query.data.shoplogo,this.getChatList(),this.getUserInfo()},created:function(){clearInterval(this.timer),this.timer=null,this.setTimer()},destroyed:function(){clearInterval(this.timer),this.timer=null},methods:{setTimer:function(){var t=this;null==this.timer&&(this.timer=setInterval(function(){t.getChatList()},3e3))},uploadImg:function(){var t=this;dsBridge.call("uploadHeadImg"),dsBridge.register("addHeadImgCallback",function(a){t.chatImg=a,t.sendChat()})},sendChat:function(){var t=this,a={userid:t.userId,shopid:"1",type:"2",content:t.content,img:t.chatImg},i=e("mw3O");t.$ajax.post("chat/addchat",i.stringify(a),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){"200"==a.data.meta.code&&(t.chatList.push({content:t.content,img:t.chatImg,type:"2"}),t.content="",t.chatImg="")}).catch(function(t){})},getChatList:function(){var t=this,a={userid:t.userId,shopid:"1"},i=e("mw3O");t.$ajax.post("chat/getchatlist",i.stringify(a),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){"200"==a.data.meta.code&&(t.chatList=a.data.data,console.log("获取了一次聊天记录"))}).catch(function(t){})},getUserInfo:function(){var t=this,a={userid:t.userId},i=e("mw3O");t.$ajax.post("user/getuserinfo",i.stringify(a),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(a){"200"==a.data.meta.code&&(t.userName=a.data.data.username,t.userImg=a.data.data.userimg)}).catch(function(t){})}}},n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"chat"}},[e("div",{staticClass:"header"},[e("div",{staticClass:"van-hairline--bottom van-nav-bar"},[e("div",{staticClass:"van-nav-bar__left"},[e("i",{staticClass:"van-icon van-icon-arrow van-nav-bar__arrow",staticStyle:{color:"#000000 !important"},on:{click:function(a){t.$router.back(-1)}}})]),t._v(" "),e("div",{staticClass:"van-ellipsis van-nav-bar__title"},[t._v(t._s(t.shopname))])])]),t._v(" "),e("div",{staticClass:"login_box text_center"},[e("div",{staticStyle:{overflow:"auto","margin-bottom":"50px"}},t._l(t.chatList,function(a,i){return e("div",{key:i},[1==a.type?e("div",{staticStyle:{float:"left",width:"100%",padding:"10px"}},[e("img",{staticStyle:{height:"30px",width:"30px",float:"left"},attrs:{src:"static/img/headImg.png"}}),t._v(" "),e("img",{staticClass:"imgLeft",attrs:{src:a.img}}),t._v(" "),a.content?e("p",{staticClass:"liaoleftyou"},[t._v(t._s(a.content))]):t._e()]):t._e(),t._v(" "),2==a.type?e("div",{staticStyle:{float:"right",width:"100%",padding:"10px"}},[e("img",{staticStyle:{height:"30px",width:"30px",float:"right"},attrs:{src:t.userImg}}),t._v(" "),e("img",{staticClass:"imgright",attrs:{src:a.img}}),t._v(" "),a.content?e("p",{staticClass:"liaorightyou"},[t._v(t._s(a.content))]):t._e()]):t._e()])})),t._v(" "),e("div",{staticClass:"chat_bottom_bar"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"chat_input",attrs:{type:"text"},domProps:{value:t.content},on:{input:function(a){a.target.composing||(t.content=a.target.value)}}}),t._v(" "),t.content?t._e():e("img",{staticClass:"chat_img_send",attrs:{src:"static/img/icon_tianjia.png"},on:{click:t.uploadImg}}),t._v(" "),t.content?e("button",{staticClass:"chat_send",on:{click:t.sendChat}},[t._v("发送")]):t._e()])])])},staticRenderFns:[]};var s=e("VU/8")(i,n,!1,function(t){e("I3BL")},"data-v-d2cdc218",null);a.default=s.exports}});
//# sourceMappingURL=12.f526285b3fab345808b2.js.map