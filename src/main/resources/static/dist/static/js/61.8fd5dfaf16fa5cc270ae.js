webpackJsonp([61],{"O/tn":function(t,i){},lVAl:function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e={name:"comment",data:function(){return{value:3,userId:localStorage.getItem("userId"),orderId:this.$route.query.data.orderid,img:"",content:"",imgList:[]}},methods:{choice:function(t){var i=this;this.$dialog.confirm({message:"请选择切换或删除该张图片",confirmButtonText:"删除",cancelButtonText:"切换"}).then(function(){for(var a=[],e=0;e<i.imgList.length;e++)e!=t&&a.push(i.imgList[e]);i.imgList=a}).catch(function(){i.changeImg(t)})},changeImg:function(t){var i=this;dsBridge.call("uploadImg"),dsBridge.register("addImgCallback",function(a){for(var e=[],s=0;s<i.imgList.length;s++)s==t?e.push(a):e.push(i.imgList[s]);i.imgList=e})},uploadImg:function(){var t=this;3==this.imgList.length?t.$toast({message:"最多可以上传3张图片!",position:"bottom"}):this.imgList.length<3&&(dsBridge.call("uploadImg"),dsBridge.register("addImgCallback",function(i){if(i.split(",").length+t.imgList.length>3)t.$toast({message:"最多可以上传3张图片!",position:"bottom"});else for(var a=0;a<i.split(",").length;a++)t.imgList.push(i.split(",")[a])}))},evaluateSubmit:function(){this.img=this.imgList.join(",");var t=this,i={userid:this.userId,orderid:this.orderId,content:this.content,score:this.value,img:this.img},e=a("mw3O");t.$ajax.post("evaluate/addevaluate",e.stringify(i),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(i){"200"==i.data.meta.code?(t.$toast({message:"评价完成!",position:"bottom"}),t.$router.push("order")):t.$toast({message:i.data.meta.msg,position:"bottom"})}).catch(function(t){})}}},s={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{attrs:{id:"comment"}},[a("div",{staticClass:"header"},[a("div",{staticClass:"van-hairline--bottom van-nav-bar"},[a("div",{staticClass:"van-nav-bar__left"},[a("i",{staticClass:"van-icon van-icon-arrow van-nav-bar__arrow",staticStyle:{color:"#000000 !important"},on:{click:function(i){t.$router.back(-1)}}})]),t._v(" "),a("div",{staticClass:"van-ellipsis van-nav-bar__title"},[t._v("发表评论")]),t._v(" "),a("div",{staticClass:"van-nav-bar__right color_40a3f3",on:{click:t.evaluateSubmit}},[t._v("\n          发布\n        ")])])]),t._v(" "),a("div",{staticClass:"login_box"},[a("div",{staticClass:"background_color_ffffff",staticStyle:{padding:"10px"}},[a("span",{staticClass:"font_14"},[t._v("评价店铺")]),t._v(" "),a("van-rate",{staticStyle:{display:"inline-block","vertical-align":"middle"},model:{value:t.value,callback:function(i){t.value=i},expression:"value"}})],1),t._v(" "),a("div",{staticClass:"background_color_ffffff",staticStyle:{padding:"10px","border-top":"1px solid #eeeeee"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"font_14",staticStyle:{width:"100%",height:"70px",border:"none"},attrs:{placeholder:"有什么想说的吗?评论给小伙伴看吧!"},domProps:{value:t.content},on:{input:function(i){i.target.composing||(t.content=i.target.value)}}}),t._v(" "),t._l(t.imgList,function(i,e){return a("img",{staticClass:"img_service",attrs:{src:i},on:{click:function(i){t.choice(e)}}})}),t._v(" "),a("img",{staticClass:"img_service",attrs:{src:"static/img/icon_tjtp_tjps.png"},on:{click:t.uploadImg}})],2)])])},staticRenderFns:[]};var n=a("VU/8")(e,s,!1,function(t){a("O/tn")},"data-v-0f1e9081",null);i.default=n.exports}});
//# sourceMappingURL=61.8fd5dfaf16fa5cc270ae.js.map